
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Tech With K">
    <title>Category: Hardware Hacking - Tech With K</title>
    <meta name="author" content="Koorosh">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Tech With K">
<meta property="og:url" content="https://blog.koorosh.dev/categories/Security/Hardware-Hacking/index.html">
<meta property="og:site_name" content="Tech With K">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Koorosh">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@kooroshh">
    
    
        
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=640"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../../../assets/css/style-z2okfa75rcu6q4cwqnoylclanmmvpaem0pebnxezbgqzaqfa3yvzryednl7s.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../../../index.html"
            aria-label=""
        >
            Tech With K
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="../../../#about"
                aria-label="Open the link: ../../../#about"
            >
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=90" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../../../#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=110" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Koorosh</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Developer / Security Researcher</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../index.html"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../https:/github.com/kooroshh"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../https:/twitter.com/MrOplus"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../mailto:koorosh@programmer.net"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2021/01/20/ZLT-Security-Analysis/"
                            aria-label=": ZLT S12 Security Analysis"
                        >
                            ZLT S12 Security Analysis
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-01-20T00:48:59+03:30">
	
		    Jan 20, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="../">Security</a>, <a class="category-link" href="">Hardware Hacking</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>ZLT S12  CPE is a cheap Chinese 4G CPE made by Shenzhen TOZED Technologies Co., LTD. also known as U.Tel in Iran or other names in some other countries.  </p>
<p><img src="/assets/images/zlt-s12.jpeg" alt="ZLT-S12"></p>
<p>as you can see from the board in the above picture the UART pins are located on the left of the board, the shell is completely unprotected  </p>
<p>the nvram configuration file is located under <code>/etc_rw/nv/main/cfg</code> which contains all users of the device  </p>
<p>the following dump contains the credentials of the device : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user_Password&#x3D;admin</span><br><span class="line">user_user&#x3D;admin</span><br><span class="line">admin_Password&#x3D;9x07bm8mbN17c</span><br><span class="line">admin_user&#x3D;Root</span><br></pre></td></tr></table></figure>
<p>the <code>admin</code> user is the <code>user</code> with the lowest access level</p>
<p>there are tons of pages that are not visible to the user level such as Firmware Upgrade, PLMN Configurations, and…  </p>
<p><img src="/assets/images/utel-goahead-disassemble.png" alt="Disassembled Binary"><br>but after I’ve disassembled the <code>/bin/goahead</code> binary of the CPE I’ve found that the ping section under the Diagnostic page of the CPE contains the Shell Injection vulnerability so if I execute the <code>127.0.0.1 | cat /etc_rw/nv/main/cfg</code> the content of the cfg file returns instead of the ping command  </p>
<p><img src="/assets/images/utel-goahead-disassemble2.png" alt="Disassembled Binary"><br>not only the ping section even the traceroute section contains the shell injection!! </p>
<p>I’ve tried to dump the firmware but I’ve found that the firmware upgrade file already exists on the internet ONLY for resellers of the CPE, so when I’ve downloaded the firmware the file was a password-protected zip, after looking at the <code>/bin/goahead</code> binary and the upgrade process I’ve found that the uploaded file will be pass to the <code>/bin/tzextract</code>  </p>
<p>the <code>/bin/tzextract</code> is a bash script that unzips the uploaded file using the <code>tzp258keeper</code> password  </p>
<p>the extracted zip file exists on my <a target="_blank" rel="noopener" href="https://github.com/kooroshh/UtelRootfs">Github repository</a></p>
<p>if the device is SimLocked you can remove the imsi_prefix using <code>nv</code> command</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2021/01/20/ZLT-Security-Analysis/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 Koorosh. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=110" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Koorosh</h4>
        
            <div id="about-card-bio"><p>Developer / Security Researcher</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Full-Stack Engineer</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../../../assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="../../../assets/js/script-geudzlmpj1goapgmb72rzubebc2mv8uts5kivsyfzo3tkm10cgpfkdcwh6yn.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
